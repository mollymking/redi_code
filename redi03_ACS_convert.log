--------------------------------------------------------------------------------
      name:  redi03_ACS_convert
       log:  /Users/mollymking/Documents/SocResearch/Dissertation/redi/redi03_AC
> S_convert.log
  log type:  text
 opened on:  27 Oct 2021, 23:10:16

. 
. //      project:        REDI Methodology Paper
. 
. //  task:       Convert back to continuous incomes
. //  data:               ACS, available: https://usa.ipums.org/
. 
. //  github:     redi
. //  OSF:                https://osf.io/qmhe8/
. 
. //  author:     Molly King
. 
. display "$S_DATE  $S_TIME"
27 Oct 2021  23:10:16

. 
. ***--------------------------***
. // # PROGRAM SETUP
. ***--------------------------***
. 
. version 16 // keeps program consistent for future replications

. set linesize 80

. clear all

. set more off

. set seed 1

. 
. use $deriv/redi02_ACS_bins.dta, clear   
(Imported original ACS data, 2016-2017)

. save $deriv/redi03_ACS_convert-hinc.dta, replace
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi03_ACS_convert-hinc
> .dta saved

. 
. local year "year"

. 
. *year of conversion factor
. local conv_year = 2017 // this is set in redi01_CPI-U-RS.do

.                 
. ***--------------------------***
. // # INCOME CONVERSIONS
. ***--------------------------***
. 
. // A) ASEC CONTINUOUS INCOME CONVERSIONS
. 
. *Converts ACS data bins (those defined by acs_hinc_shp) into continuous REDI v
> alues, using values found in ASEC
. 
. include $redi/redi03a_categ_distrib.doi

. *! Include file to convert categorical to continuous income values, independen
> t of values of categories
. *! creates numeric variables indicating edges of income categories,
. *! and draws random continuous income from CPS-ASEC from between those edges
. 
. *! version 4.0 \ molly king 2020-08-25
. 
. ***--------------------------***
. 
. // #1 SETUP
.         *noisily
.         *set seed 1 // when commented out - selection from CPS-ASEC is random
.         compress
  variable acs_hinc_shp was float now byte
  (19,039,581 bytes saved)

. 
.         cd $temp
/Users/mollymking/Documents/SocResearch/Dissertation/data/data_temp

.         
.         //Create local for levels of income = e.g., levelsof year, local(years
> )
.         levelsof acs_hinc_shp, local("acs_hinc_shp_levels")
1 2 3 4 5 6 7 8 9

. 
.         // sort for later join & create variable recording the original observ
> ation order within the identifier
.         *bysort year acs_hinc_shp: gen year_inc_id = _n
.         bysort year acs_hinc_shp: gen id = _n

. 
. // #2 create numeric variables indicating edges of income categories //
.         // Note: for more detail on if-command and Stata regular expressions u
> sed to create this, see:
.                 *http://www.stata.com/statalist/archive/2013-03/msg00654.html
.                 *http://www.stata.com/support/faqs/programming/if-command-vers
> us-if-qualifier/
.                 *http://stats.idre.ucla.edu/stata/faq/how-can-i-extract-a-port
> ion-of-a-string-variable-using-regular-expressions/
. 
.         // List income levels
.         di in red "The income levels are: " "`acs_hinc_shp_levels'"
The income levels are: 1 2 3 4 5 6 7 8 9

. 
.         * Decode converts labels to string variables for acs_hinc_shp
.         decode acs_hinc_shp, gen(inc_decoded)

. 
.         tempfile working_regex

.         save `working_regex', replace
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000001 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000001 saved

. 
.         
.         //Levels of year variable to loop through years in dataset
.         levelsof year, local(years)
2016 2017

.         di in red  "Create local variable years to loop through within that in
> come bracket - values:" `years'
Create local variable years to loop through within that income bracket - values:
> 20162017

. 
.         foreach y of local years { // loop through all years
  2. 
.         
.                 // loop through all values of income categories (`inc_level')
.                 foreach inc_level of local acs_hinc_shp_levels {
  3. 
.                         use `working_regex', clear
  4. 
.                         // Keep the data if the income variable is equal to th
> e current income level (of the loop)
.                         keep if acs_hinc_shp == `inc_level'  // do this to mak
> e sure not replacing things with wrong level later
  5.                         di "The current inc_level is: " `inc_level'
  6. 
.                         // text at beginning of the string:
.                                 if regexm(inc_decoded, "^[a-z/A-Z]+") == 1 {
  7.                                         di "The inc_level " `inc_level' " i
> s at the lowest end of the original ACS income range"
  8.                                         // for lower-bound values, will mat
> ch if text at beginning of line
.                                         destring inc_decoded, ignore("Less tha
> n LESS THAN Under,$ ") generate(acs_hinc_shp_ub) // parses out these words
  9.                                         gen acs_hinc_shp_lb = -100000
 10.                                         di "Lower bound of -100,000 created
>  for inc_level " `inc_level'
 11.                                 }
 12. 
.                         // text at end of the string:
.                                 else if regexm(inc_decoded, "[a-z/A-Z]+$") == 
> 1 {
 13.                                         di "The inc_level " `inc_level' " i
> s at the highest end of the original ACS income range"
 14.                                         // for upper-bound values, will mat
> ch if text at end of line
.                                         destring inc_decoded, ignore("and over
>  or over,$ or more OR MORE") generate(acs_hinc_shp_lb) // parses out these wor
> ds
 15.                                         gen acs_hinc_shp_ub = 999999  // my
>  topcode for asec purposes
 16.                                         di "Upper bound of 999999 created f
> or inc_level " `inc_level'
 17.                                 }
 18. 
.                         // if acs_hinc_shp is missing, keep it missing for low
> er_bound and upper_bound
.                                 else if regexm(inc_decoded, "[.][a-z]") == 1 {
 19.                                         di "The inc_level " `inc_level' " i
> s all missing"
 20.                                  // for missing values (a bit excessive, si
> nce already missing, but good to be sure)
.                                         gen acs_hinc_shp_lb = .
 21.                                         gen acs_hinc_shp_ub = .
 22.                                         di "Lower and upper bound of . crea
> ted for inc_level " `inc_level'
 23.                                 }
 24. 
.                         // for labels with 2 numbers in them
.                                 else if regexm(inc_decoded, "[0-9]+$") == 1 {
 25.                                 // regex "[0-9]+$" will match anything of f
> orm $0000 or 0000 at end of line -
.                                 // since those at lowest and highest ranges ha
> ve already been matched (using text), this leaves those with ranges
.                                                 di "The inc_level " `inc_level
> ' " has a lower and an upper level"
 26.                                                 split inc_decoded, ///
>                                                         parse("-" "to" "-" "to
>  under" "to less than" "UP TO" "but less than") ///
>                                                         ignore(" ,$") destring
 27.                                                 gen acs_hinc_shp_lb = inc_d
> ecoded1
 28.                                                 gen acs_hinc_shp_ub = inc_d
> ecoded2
 29.                                                 di "Lower bound of acs_hinc
> _shp_lb and upper bound of acs_hinc_shp_ub created for inc_level " `inc_level'
>  "of the original ACS income range"
 30.                                 }
 31. 
.                         // error - in case doesn't fit any existing category
.                                 else {
 32.                                         di "The inc_level " `inc_level' " d
> oes not fit any of the existing regular expressions designs."
 33.                                 }
 34. 
.                         // create locals to use later for selecting appropriat
> e ASEC bounds
.                                 local upper_bound = acs_hinc_shp_ub
 35.                                 local lower_bound = acs_hinc_shp_lb
 36. 
.                 // drop variables used in creating lower and upper bounds
.                         capture drop inc_decoded1 inc_decoded2
 37. 
.                 // #3A Now, still within the single-income-level loop in ACS d
> ataset:
. 
.                         // summarize so can get count of how many individuals 
> in that income level during year
.                                 quietly summarize if year == `y' & acs_hinc_sh
> p == `inc_level'
 38.                                 local sample_size = r(N) // count how many 
> rows there are in survey dataset
 39.                                   // count N_B for each bin (# of observati
> ons in ACS income category between L_bn and U_bn)
.                                 
.                                 // create count within each ACS income bin
.                                 gen acs_hinc_shp_n = `sample_size' // contains
>  size of bin in ACS dataset
 40.                                 label variable acs_hinc_shp_n "household (A
> CS) shp count of respondents in each income bin in original (research) dataset
> "
 41. 
. 
.                         // create temporary file of just this ACS income level
>  and year
.                                 keep if year == `y' & acs_hinc_shp == `inc_lev
> el'
 42.                                 tempfile premerge_`inc_level'_`y'
 43.                                 save `premerge_`inc_level'_`y'', replace
 44.                                 
.                                 use $deriv/redi01_ASEC-hhincome.dta, clear // 
> use ASEC household dataset
 45.                                 *use $temp/redi14_cps_state_ca.dta, clear /
> / $temp/redi14_cps_state_wy.dta
.                                 di "Calculating household income using hhincom
> e ASEC variable."
 46. 
.                         // #3B) Takes a random draw of number of incomes w/in 
> that income boundary and year from the CPS-ASEC
.                         // Keep ASEC data if within income bounds and for give
> n year
. 
.                                 keep if year == `y' & ///
>                                         hhincome_asec >= `lower_bound' & ///
>                                         hhincome_asec <= `upper_bound'
 47.                                 gen obs_no = _n
 48.                                 save "$deriv/redi01_ASEC-hhincome_year_inc`
> inc_level'.dta", replace
 49.                                 di "Keep income between $`lower_bound' and 
> $`upper_bound' for `y' year."
 50.                         
.                         // #3C) Sample, with replacement, such that ASEC incom
> e has an equal 
.                         // probability assigned to each observation in this ar
> tificial data set 
.                         // (which will later be matched to ACS data set)
.                         // Thanks to Clyde Schechter; https://www.statalist.or
> g/forums/forum/general-stata-discussion/general/1475890-is-there-a-command-tha
> t-is-equivalent-to-bsample-more-than-_n
.                                 quietly des 
 51.                                 local N = r(N)
 52. 
.                                 clear
 53.                                 set obs `sample_size'
 54.                                 *set seed 1
. 
.                                 gen obs_no = runiformint(1, `N')
 55.                                 merge m:1 obs_no using "$deriv/redi01_ASEC-
> hhincome_year_inc`inc_level'.dta", keep(match) nogenerate 
 56.                                                                            
>                              
.                         // #3D) Add new columns for lower_bound and upper_boun
> d of income bin
.                                 gen acs_hinc_shp_lb = `lower_bound'
 57.                                 gen acs_hinc_shp_ub = `upper_bound'
 58.                         // Label new upper and lower income bound variables
.                                 label variable acs_hinc_shp_lb "acs_hinc_shp L
> ower Bound"
 59.                                 label variable acs_hinc_shp_ub "acs_hinc_sh
> p Upper Bound"
 60. 
.                                 save "$deriv/redi01_ASEC-hhincome_year_inc`inc
> _level'.dta", replace
 61.                                 
. 
.                         // #4) Merge ACS (using=premerge) and ASEC data (maste
> r) 
.                         // here, ASEC artificial datase (from step 3A) is matc
> hed 
.                         // to ACS for that incomebin for that year            
>                                                   
.                                 gen id = _n
 62.                                 merge 1:1 id using `premerge_`inc_level'_`y
> ''
 63.                                 
.                                 di "Merged ASEC values with original ACS datas
> et for inc_level " `inc_level' ///
>                                    " ($`lower_bound'-`upper_bound') and year `
> y'."
 64.                                                 
.                         // #5) create count within each REDI income bin
.                                 generate        redi_hinc_shp_n = .
 65.                                 replace         redi_hinc_shp_n = `N' // r(
> N) from above
 66.                                 label var       redi_hinc_shp_n "household 
> (REDI) shp count of respondents in each income bin in post-merge dataset'"
 67. 
.                         // Save these new redi data (with yearly ASEC continuo
> us data) in a tempfile we can use later for merging, etc.
.                                 tempfile temp_`inc_level'_`y'
 68.                                 save `temp_`inc_level'_`y'', replace
 69.                                 di "Saved REDI data (with ASEC continuous d
> ata) for inc_level " `inc_level' " ($`lower_bound'-`upper_bound') and year `y'
>  in file"
 70.                 
.                 }  //  close loop through all values of income categories (`in
> c_level')
 71.                                 
.                 di  in red "Moved outside loop of year income bracket " `inc_l
> evel' " ($`lower_bound'-`upper_bound')."
 72.                 
.                 // append all income brackets across all years
.                         tokenize `acs_hinc_shp_levels'
 73.                         local first `1'
 74.                         use `temp_`1'_`y'', clear
 75.                         macro shift
 76.                         local rest `*'
 77. 
.                 // now loop through and append each temp file created within i
> ncome bracket loop
.                         foreach bracket in `*' {
 78.                                 append using `temp_`bracket'_`y''
 79.                         }
 80. 
.                 // create new tempfile to save each year's data for all income
>  levels
.                         tempfile temp_`y'
 81.                         save `temp_`y'', replace
 82.                         di "Saved new tempfile  for year `y' for all REDI i
> ncome brackets."
 83. 
.                                                 
.         } //  end of loop through all years
(Imported original ACS data, 2016-2017)
(5,891,121 observations deleted)
The current inc_level is: 1
The inc_level 1 is at the lowest end of the original ACS income range
inc_decoded: characters L e s space t h a n $ removed; acs_hinc_shp_ub generated
>  as int
Lower bound of -100,000 created for inc_level 1
note: label truncated to 80 characters
(222,379 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000002 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000002 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(131,174 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc1.dta saved
Keep income between $-100000 and $15000 for 2016 year.
number of observations (_N) was 0, now 233,027

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           233,027  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc1.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           233,027  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 1 ($-100000-15000) an
> d year 2016.
(233,027 missing values generated)
(233,027 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000003 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000003 saved
Saved REDI data (with ASEC continuous data) for inc_level 1 ($-100000-15000) and
>  year 2016 in file
(Imported original ACS data, 2016-2017)
(5,908,783 observations deleted)
The current inc_level is: 2
The inc_level 2 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as int
inc_decoded2: character space removed; replaced as int
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 2of the original ACS income range
note: label truncated to 80 characters
(214,506 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000004 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000004 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(132,101 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc2.dta saved
Keep income between $15000 and $25000 for 2016 year.
number of observations (_N) was 0, now 223,238

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           223,238  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc2.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           223,238  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 2 ($15000-25000) and 
> year 2016.
(223,238 missing values generated)
(223,238 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000005 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000005 saved
Saved REDI data (with ASEC continuous data) for inc_level 2 ($15000-25000) and y
> ear 2016 in file
(Imported original ACS data, 2016-2017)
(5,872,606 observations deleted)
The current inc_level is: 3
The inc_level 3 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as int
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 3of the original ACS income range
note: label truncated to 80 characters
(232,186 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000006 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000006 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(132,369 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc3.dta saved
Keep income between $25000 and $35000 for 2016 year.
number of observations (_N) was 0, now 241,735

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           241,735  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc3.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           241,735  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 3 ($25000-35000) and 
> year 2016.
(241,735 missing values generated)
(241,735 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000007 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000007 saved
Saved REDI data (with ASEC continuous data) for inc_level 3 ($25000-35000) and y
> ear 2016 in file
(Imported original ACS data, 2016-2017)
(5,617,011 observations deleted)
The current inc_level is: 4
The inc_level 4 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 4of the original ACS income range
note: label truncated to 80 characters
(361,132 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000008 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000008 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(130,385 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc4.dta saved
Keep income between $35000 and $50000 for 2016 year.
number of observations (_N) was 0, now 368,384

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           368,384  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc4.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           368,384  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 4 ($35000-50000) and 
> year 2016.
(368,384 missing values generated)
(368,384 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000009 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000009 saved
Saved REDI data (with ASEC continuous data) for inc_level 4 ($35000-50000) and y
> ear 2016 in file
(Imported original ACS data, 2016-2017)
(5,275,397 observations deleted)
The current inc_level is: 5
The inc_level 5 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 5of the original ACS income range
note: label truncated to 80 characters
(534,663 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000a not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000a saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(127,661 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc5.dta saved
Keep income between $50000 and $75000 for 2016 year.
number of observations (_N) was 0, now 536,467

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           536,467  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc5.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           536,467  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 5 ($50000-75000) and 
> year 2016.
(536,467 missing values generated)
(536,467 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000b not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000b saved
Saved REDI data (with ASEC continuous data) for inc_level 5 ($50000-75000) and y
> ear 2016 in file
(Imported original ACS data, 2016-2017)
(5,484,627 observations deleted)
The current inc_level is: 6
The inc_level 6 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 6of the original ACS income range
note: label truncated to 80 characters
(434,733 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000c not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000c saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(130,837 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc6.dta saved
Keep income between $75000 and $100000 for 2016 year.
number of observations (_N) was 0, now 427,167

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           427,167  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc6.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           427,167  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 6 ($75000-100000) and
>  year 2016.
(427,167 missing values generated)
(427,167 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000d not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000d saved
Saved REDI data (with ASEC continuous data) for inc_level 6 ($75000-100000) and 
> year 2016 in file
(Imported original ACS data, 2016-2017)
(5,322,945 observations deleted)
The current inc_level is: 7
The inc_level 7 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 7of the original ACS income range
note: label truncated to 80 characters
(522,665 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000e not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000e saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(129,345 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc7.dta saved
Keep income between $100000 and $150000 for 2016 year.
number of observations (_N) was 0, now 500,917

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           500,917  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc7.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           500,917  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 7 ($100000-150000) an
> d year 2016.
(500,917 missing values generated)
(500,917 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000f not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000f saved
Saved REDI data (with ASEC continuous data) for inc_level 7 ($100000-150000) and
>  year 2016 in file
(Imported original ACS data, 2016-2017)
(5,889,320 observations deleted)
The current inc_level is: 8
The inc_level 8 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 8of the original ACS income range
note: label truncated to 80 characters
(237,220 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000g not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000g saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(135,045 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc8.dta saved
Keep income between $150000 and $200000 for 2016 year.
number of observations (_N) was 0, now 219,987

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           219,987  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc8.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           219,987  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 8 ($150000-200000) an
> d year 2016.
(219,987 missing values generated)
(219,987 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000h not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000h saved
Saved REDI data (with ASEC continuous data) for inc_level 8 ($150000-200000) and
>  year 2016 in file
(Imported original ACS data, 2016-2017)
(5,809,046 observations deleted)
The current inc_level is: 9
The inc_level 9 is at the highest end of the original ACS income range
inc_decoded: characters space o e r m removed; acs_hinc_shp_lb generated as long
Upper bound of 999999 created for inc_level 9
note: label truncated to 80 characters
(279,997 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000i not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000i saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(135,402 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc9.dta saved
Keep income between $200000 and $999999 for 2016 year.
number of observations (_N) was 0, now 257,484

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           257,484  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc9.dta saved
(note: variable acs_hinc_shp_lb was float, now double to accommodate using
       data's values)
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           257,484  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 9 ($200000-999999) an
> d year 2016.
(257,484 missing values generated)
(257,484 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000j not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000j saved
Saved REDI data (with ASEC continuous data) for inc_level 9 ($200000-999999) and
>  year 2016 in file
Moved outside loop of year income bracket  ($200000-999999).
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(note: variable acs_hinc_shp_lb was float, now double to accommodate using
       data's values)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000k not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000k saved
Saved new tempfile  for year 2016 for all REDI income brackets.
(Imported original ACS data, 2016-2017)
(5,891,121 observations deleted)
The current inc_level is: 1
The inc_level 1 is at the lowest end of the original ACS income range
inc_decoded: characters L e s space t h a n $ removed; acs_hinc_shp_ub generated
>  as int
Lower bound of -100,000 created for inc_level 1
note: label truncated to 80 characters
(233,027 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000l not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000l saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(131,323 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc1.dta saved
Keep income between $-100000 and $15000 for 2017 year.
number of observations (_N) was 0, now 222,379

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           222,379  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc1.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           222,379  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 1 ($-100000-15000) an
> d year 2017.
(222,379 missing values generated)
(222,379 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000m not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000m saved
Saved REDI data (with ASEC continuous data) for inc_level 1 ($-100000-15000) and
>  year 2017 in file
(Imported original ACS data, 2016-2017)
(5,908,783 observations deleted)
The current inc_level is: 2
The inc_level 2 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as int
inc_decoded2: character space removed; replaced as int
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 2of the original ACS income range
note: label truncated to 80 characters
(223,238 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000n not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000n saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(132,584 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc2.dta saved
Keep income between $15000 and $25000 for 2017 year.
number of observations (_N) was 0, now 214,506

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           214,506  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc2.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           214,506  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 2 ($15000-25000) and 
> year 2017.
(214,506 missing values generated)
(214,506 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000o not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000o saved
Saved REDI data (with ASEC continuous data) for inc_level 2 ($15000-25000) and y
> ear 2017 in file
(Imported original ACS data, 2016-2017)
(5,872,606 observations deleted)
The current inc_level is: 3
The inc_level 3 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as int
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 3of the original ACS income range
note: label truncated to 80 characters
(241,735 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000p not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000p saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(132,715 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc3.dta saved
Keep income between $25000 and $35000 for 2017 year.
number of observations (_N) was 0, now 232,186

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           232,186  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc3.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           232,186  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 3 ($25000-35000) and 
> year 2017.
(232,186 missing values generated)
(232,186 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000q not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000q saved
Saved REDI data (with ASEC continuous data) for inc_level 3 ($25000-35000) and y
> ear 2017 in file
(Imported original ACS data, 2016-2017)
(5,617,011 observations deleted)
The current inc_level is: 4
The inc_level 4 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 4of the original ACS income range
note: label truncated to 80 characters
(368,384 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000r not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000r saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(130,332 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc4.dta saved
Keep income between $35000 and $50000 for 2017 year.
number of observations (_N) was 0, now 361,132

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           361,132  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc4.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           361,132  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 4 ($35000-50000) and 
> year 2017.
(361,132 missing values generated)
(361,132 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000s not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000s saved
Saved REDI data (with ASEC continuous data) for inc_level 4 ($35000-50000) and y
> ear 2017 in file
(Imported original ACS data, 2016-2017)
(5,275,397 observations deleted)
The current inc_level is: 5
The inc_level 5 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 5of the original ACS income range
note: label truncated to 80 characters
(536,467 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000t not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000t saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(127,464 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc5.dta saved
Keep income between $50000 and $75000 for 2017 year.
number of observations (_N) was 0, now 534,663

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           534,663  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc5.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           534,663  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 5 ($50000-75000) and 
> year 2017.
(534,663 missing values generated)
(534,663 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000u not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000u saved
Saved REDI data (with ASEC continuous data) for inc_level 5 ($50000-75000) and y
> ear 2017 in file
(Imported original ACS data, 2016-2017)
(5,484,627 observations deleted)
The current inc_level is: 6
The inc_level 6 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 6of the original ACS income range
note: label truncated to 80 characters
(427,167 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000v not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000v saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(130,672 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc6.dta saved
Keep income between $75000 and $100000 for 2017 year.
number of observations (_N) was 0, now 434,733

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           434,733  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc6.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           434,733  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 6 ($75000-100000) and
>  year 2017.
(434,733 missing values generated)
(434,733 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000w not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000w saved
Saved REDI data (with ASEC continuous data) for inc_level 6 ($75000-100000) and 
> year 2017 in file
(Imported original ACS data, 2016-2017)
(5,322,945 observations deleted)
The current inc_level is: 7
The inc_level 7 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 7of the original ACS income range
note: label truncated to 80 characters
(500,917 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000x not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.00000x saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(129,189 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc7.dta saved
Keep income between $100000 and $150000 for 2017 year.
number of observations (_N) was 0, now 522,665

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           522,665  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc7.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           522,665  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 7 ($100000-150000) an
> d year 2017.
(522,665 missing values generated)
(522,665 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000010 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000010 saved
Saved REDI data (with ASEC continuous data) for inc_level 7 ($100000-150000) and
>  year 2017 in file
(Imported original ACS data, 2016-2017)
(5,889,320 observations deleted)
The current inc_level is: 8
The inc_level 8 has a lower and an upper level
variables born as string: 
inc_decoded1  inc_decoded2
inc_decoded1: character space removed; replaced as long
inc_decoded2: character space removed; replaced as long
Lower bound of acs_hinc_shp_lb and upper bound of acs_hinc_shp_ub created for in
> c_level 8of the original ACS income range
note: label truncated to 80 characters
(219,987 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000011 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000011 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(134,776 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc8.dta saved
Keep income between $150000 and $200000 for 2017 year.
number of observations (_N) was 0, now 237,220

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           237,220  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc8.dta saved
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           237,220  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 8 ($150000-200000) an
> d year 2017.
(237,220 missing values generated)
(237,220 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000012 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000012 saved
Saved REDI data (with ASEC continuous data) for inc_level 8 ($150000-200000) and
>  year 2017 in file
(Imported original ACS data, 2016-2017)
(5,809,046 observations deleted)
The current inc_level is: 9
The inc_level 9 is at the highest end of the original ACS income range
inc_decoded: characters space o e r m removed; acs_hinc_shp_lb generated as long
Upper bound of 999999 created for inc_level 9
note: label truncated to 80 characters
(257,484 observations deleted)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000013 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000013 saved
(CPS ASEC data - Household Income - 2016-2017)
Calculating household income using hhincome ASEC variable.
(134,810 observations deleted)
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc9.dta saved
Keep income between $200000 and $999999 for 2017 year.
number of observations (_N) was 0, now 279,997

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           279,997  
    -----------------------------------------
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi01_ASEC-hhincome_ye
> ar_inc9.dta saved
(note: variable acs_hinc_shp_lb was float, now double to accommodate using
       data's values)
(label diffmob_lbl already defined)
(label migrate1_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label hispan_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label sex_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           279,997  (_merge==3)
    -----------------------------------------
Merged ASEC values with original ACS dataset for inc_level 9 ($200000-999999) an
> d year 2017.
(279,997 missing values generated)
(279,997 real changes made)
note: label truncated to 80 characters
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000014 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000014 saved
Saved REDI data (with ASEC continuous data) for inc_level 9 ($200000-999999) and
>  year 2017 in file
Moved outside loop of year income bracket  ($200000-999999).
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(note: variable acs_hinc_shp_lb was float, now double to accommodate using
       data's values)
(label _merge already defined)
(label cat_inc already defined)
(label sample_lbl already defined)
(label repwt_lbl already defined)
(label gq_lbl already defined)
(label ownershpd_lbl already defined)
(label repwtp_lbl already defined)
(label raced_lbl already defined)
(label hispand_lbl already defined)
(label educd_lbl already defined)
(label migrate1d_lbl already defined)
(label union_lbl already defined)
(label health_lbl already defined)
(label migrate1_lbl already defined)
(label whymove_lbl already defined)
(label diffmob_lbl already defined)
(label educ_lbl already defined)
(label labforce_lbl already defined)
(label hispan_lbl already defined)
(label nchild_lbl already defined)
(label marst_lbl already defined)
(label race_lbl already defined)
(label sex_lbl already defined)
(label age_lbl already defined)
(label ownershp_lbl already defined)
(label statefip_lbl already defined)
(label asecflag_lbl already defined)
(label month_lbl already defined)
(note: file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000015 not
>  found)
file /var/folders/rp/96l526kj7ybdjr5vs5bqqjw80000gn/T//S_01742.000015 saved
Saved new tempfile  for year 2017 for all REDI income brackets.

.                                 
.                 // append all years 
.                         tokenize `years'

.                         local first `1'

.                         use `temp_`1'', clear

.                         macro shift

.                         local rest `*'

. 
.                 // now loop through and append each yearly temp file created e
> arlier
.                         foreach ytemp in `*' {
  2.                                 append using `temp_`ytemp''
  3.                         }
(label month_lbl already defined)
(label asecflag_lbl already defined)
(label statefip_lbl already defined)
(label ownershp_lbl already defined)
(label age_lbl already defined)
(label sex_lbl already defined)
(label race_lbl already defined)
(label marst_lbl already defined)
(label nchild_lbl already defined)
(label hispan_lbl already defined)
(label labforce_lbl already defined)
(label educ_lbl already defined)
(label diffmob_lbl already defined)
(label whymove_lbl already defined)
(label migrate1_lbl already defined)
(label health_lbl already defined)
(label union_lbl already defined)
(label migrate1d_lbl already defined)
(label educd_lbl already defined)
(label hispand_lbl already defined)
(label raced_lbl already defined)
(label repwtp_lbl already defined)
(label ownershpd_lbl already defined)
(label gq_lbl already defined)
(label repwt_lbl already defined)
(label sample_lbl already defined)
(label cat_inc already defined)
(label _merge already defined)

.                         di "Appended all years "
Appended all years 

. 
. // CLEAN UP
. 
. sort year acs_hinc_shp id

. drop obs_no id inc_decoded

. 
. tab _merge

                 _merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
            matched (3) |  6,047,887      100.00      100.00
------------------------+-----------------------------------
                  Total |  6,047,887      100.00

. drop _merge

. 
. di in red "End of redi03a_categ_distrib.doi for household and shp variables" 
End of redi03a_categ_distrib.doi for household and shp variables

. 
. 
. save $deriv/redi03_ACS_convert-hinc_shp.dta, replace
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi03_ACS_convert-hinc
> _shp.dta saved

. 
.         
. // B) INFLATION ADJUSTMENT: CONVERT CONTINUOUS INCOME TO `conv_year' DOLLARS
. 
. include $redi/redi03b_inflate_dollars.doi

. *! Include file to convert continuous income values
.  *! from whatever year they are currently in to `conv_year' dollars
. *! using CPI-U-RS
. 
. *! version 4.0 \ molly king 2020-08-21
. 
. ***-----------------------------***
. 
. // #1 SETUP
. 
. *noisily
. set seed 1

. di in red "Begin redi03b_inflate_dollars.doi for household and shp variables"
Begin redi03b_inflate_dollars.doi for household and shp variables

. compress
  variable redi_hinc_shp_n was float now int
  variable acs_hinc_shp_lb was double now long
  (36,287,322 bytes saved)

. 
. ***-----------------------------***
.         
. // #2 Merge with CPI-U-RS Inflation Data
. 
. merge m:1 year using $deriv/redi01_CPI-U-RS.dta

    Result                           # of obs.
    -----------------------------------------
    not matched                            39
        from master                         0  (_merge==1)
        from using                         39  (_merge==2)

    matched                         6,047,887  (_merge==3)
    -----------------------------------------

. 
. drop _merge

. 
. ***-----------------------------***
. 
. // #3 INFLATION-ADJUSTED INCOME
. 
. *divide continuous income variable by conversion factor
. 
. gen redi_dV_hinc_shp_`conv_year' = hhincome_asec / conv_factor
(39 missing values generated)

. format redi_dV_hinc_shp_`conv_year' %6.0fc

. label var redi_dV_hinc_shp_`conv_year' "REDI continuous inflation-adjusted hou
> sehold income (ACS), from shp categories, `conv_year' dollars"
note: label truncated to 80 characters

. 
. gen acs_hinc_shp_`conv_year'ub = acs_hinc_shp_ub / conv_factor
(39 missing values generated)

. format acs_hinc_shp_`conv_year'ub %6.0fc

. label var acs_hinc_shp_`conv_year'ub "Inflation-adjusted Upper Bound for redi_
> dV_hinc_shp_`conv_year', from shp categories, `conv_year' dollars"
note: label truncated to 80 characters

. 
. gen acs_hinc_shp_`conv_year'lb = acs_hinc_shp_lb / conv_factor
(39 missing values generated)

. format acs_hinc_shp_`conv_year'lb %6.0fc

. label var acs_hinc_shp_`conv_year'lb "Inflation-adjusted Lower Bound for redi_
> dV_hinc_shp_`conv_year', from shp categories, `conv_year' dollars"
note: label truncated to 80 characters

. 
. *original income variable, adjusted for inflation
. local inflated_research_var "acs_hinc_shp_`conv_year'"

. gen acs_hinc_shp_`conv_year' = hhincome_acs / conv_factor
(39 missing values generated)

. format acs_hinc_shp_`conv_year' %6.0fc

. label var acs_hinc_shp_`conv_year' "REDI continuous inflation-adjusted househo
> ld income (ACS), from shp categories, `conv_year' dollars"
note: label truncated to 80 characters

.                 
. 
. di in red "End of redi03b_inflate_dollars.doi for household and shp variables"
>  
End of redi03b_inflate_dollars.doi for household and shp variables

. 
. 
.                 
. 
. ***--------------------------***
. // # CLEAN UP - variables brought from ASEC
. ***--------------------------***
. 
. keep if year == 2016 | year == 2017     
(39 observations deleted)

. *drop asecwth cpi_avg conv_factor_2017 repwt pers_inc 
. 
. ***--------------------------***
. // # SAVE DATA 
. ***--------------------------***
. 
. label data "ACS data converted to continuous REDI-calculated values"

. notes: redi03_ACS_convert-hinc_shp.dta \ ///
>         ACS hinc_shp Data converted to continuous \ /// 
>         redi03_ACS_convert.do  $S_DATE

. compress
  (0 bytes saved)

. datasignature set, reset  
  6047887:222(27879):2627204792:2771182108       (data signature reset)

. 
. save $deriv/redi03_ACS_convert-hinc_shp.dta, replace
file ~/Documents/SocResearch/Dissertation/data/data_derv/redi03_ACS_convert-hinc
> _shp.dta saved

. 
. di in red "End of redi_inflate_dollars.doi for household and shp variables" 
End of redi_inflate_dollars.doi for household and shp variables

. 
. 
. ***--------------------------***
. 
. log close redi03_ACS_convert
      name:  redi03_ACS_convert
       log:  /Users/mollymking/Documents/SocResearch/Dissertation/redi/redi03_AC
> S_convert.log
  log type:  text
 closed on:  27 Oct 2021, 23:53:19
--------------------------------------------------------------------------------
